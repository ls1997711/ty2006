"use strict";function _typeof(n){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(n)}!function(i,a){var s=null,l=null,c=null,r=null,u=null,h=null,p=0,d=0,f=0,m=null,v=null,g="current",x=null,y=null,_=null,w=null,z=null,I=0,b=0,W=[],H=null,M=null,P=null,S=null,B=null,j=null,k=0,q=0,N={},t={navWidth:60,navHeight:60,navItemNum:5,navItemMargin:6,navBorder:1,autoPlay:!0,autoPlayTimeout:2e3},e={init:function(n){var e,o,n=i.extend({},t,n);l=(s=this).find(".exzoom_img_box"),h=s.find(".exzoom_img_ul"),m=s.find(".exzoom_nav"),w=s.find(".exzoom_prev_btn"),z=s.find(".exzoom_next_btn"),r=c=s.outerWidth(),N.navWidth=n.navWidth,N.navHeight=n.navHeight,N.navBorder=n.navBorder,N.navItemMargin=n.navItemMargin,N.navItemNum=n.navItemNum,N.autoPlay=n.autoPlay,N.autoPlayTimeout=n.autoPlayTimeout,_=l.find("img"),I=_.length,e=_,o=setInterval(function(){var n=0,t=e.length;e.each(function(){this.complete&&n++}),n===t&&(clearInterval(o),function(){l.append("<div class='exzoom_img_ul_outer'></div>"),m.append("<p class='exzoom_nav_inner'></p>"),u=l.find(".exzoom_img_ul_outer"),v=m.find(".exzoom_nav_inner"),u.append(h);for(var n=0;n<I;n++){W[n]=F(_.eq(n)),console.log(W[n]);var t=h.find("li").eq(n);t.css("width",c),t.find("img").css({"margin-top":W[n][5],width:W[n][3]})}x=m.find("span"),y=2*N.navBorder+N.navHeight,N.exzoom_navWidth=(y+N.navItemMargin)*N.navItemNum,N.exzoom_nav_innerWidth=(y+N.navItemMargin)*I,x.eq(b).addClass(g),m.css({height:y+"px",width:c-w.width()-z.width()}),v.css({width:N.exzoom_nav_innerWidth+"px"}),x.css({"margin-right":N.navItemMargin+"px",width:N.navWidth+"px",height:N.navHeight+"px"}),d=c*I,f=c*(I-1),h.css("width",d),l.append("\n<div class='exzoom_zoom_outer'>\n    <span class='exzoom_zoom'></span>\n</div>\n<p class='exzoom_preview'>\n    <img class='exzoom_preview_img' src='' />\n</p>\n            "),H=l.find(".exzoom_zoom"),M=l.find(".exzoom_main_img"),P=l.find(".exzoom_zoom_outer"),S=l.find(".exzoom_preview"),B=l.find(".exzoom_preview_img"),l.css({width:r+"px",height:r+"px"}),u.css({width:r+"px",height:r+"px"}),S.css({width:r+"px",height:r+"px",left:r+5+"px"}),D(W[b]),A(),h.on("touchstart",function(n){n=T(n);k=n.x,n.y;n=h.css("left");p=parseInt(n),a.clearInterval(j)}),h.on("touchmove",function(n){n=T(n);q=n.x,n.y,n=C(n=p+q-k),h.css("left",n)}),h.on("touchend",function(n){console.log(q<k),q<k?X():k<q&&Y(),A()}),P.on("mousedown",function(n){n=T(n);k=n.x,n.y;n=h.css("left");p=parseInt(n)}),P.on("mouseup",function(n){var t=s.offset();k-t.left<c/2?Y():k-t.left>c/2&&X()}),s.on("mouseenter",function(){a.clearInterval(j)}),s.on("mouseleave",function(){A()}),P.on("mouseenter",function(){H.css("display","block"),S.css("display","block")}),P.on("mousemove",function(n){var t=H.width()/2,e=P.width()-t,o=P.height()-t,i=n.pageX-P.offset().left,a=n.pageY-P.offset().top,s=i-t,n=a-t;i<=t&&(s=0),e<=i&&(s=e-t),a<=t&&(n=0),o<=a&&(n=o-t),H.css({left:s+"px",top:n+"px"}),B.css({left:-s*S.width()/H.width()+"px",top:-n*S.width()/H.width()+"px"})}),P.on("mouseleave",function(){H.css("display","none"),S.css("display","none")}),S.on("mouseenter",function(){H.css("display","none"),S.css("display","none")}),z.on("click",function(){X()}),w.on("click",function(){Y()}),x.hover(function(){Q(b=i(this).index())})}())},100)},prev:function(){Y()},next:function(){X()},setImg:function(){var e=arguments[0];E(e,function(n,t){B.attr("src",e),M.attr("src",e),h.find("li").length===I+1&&h.find("li:last").remove(),h.append('<li style="width: '+c+'px;"><img src="'+e+'"></li>'),D(F(e,n,t))})}};function T(n){var t=n||a.event,n=t;return void 0!==t.touches&&0<t.touches.length&&(n=t.touches[0]),{x:n.clientX||n.pageX,y:n.clientY||n.pageY}}function C(n){return f<-n?(n=-f,b=0):0<n&&(n=0),n}function Q(n){void 0===n&&alert("exzoom 中的 move 函数的 direction 参数必填"),b>W.length-1&&(b=0),x.eq(b).addClass(g).siblings().removeClass(g);var t=m.width(),e=0,n=(N.navItemMargin+N.navWidth+2*N.navBorder)*(b+1);t<n&&(e=c-n),v.css({left:e});e=C(e=-c*b);h.stop().animate({left:e},500),D(W[b])}function X(){I<++b&&(b=I),Q("right")}function Y(){--b<0&&(b=0),Q("left")}function A(){N.autoPlay&&(j=a.setInterval(function(){I<=b&&(b=0),b++,Q("right")},N.autoPlayTimeout))}function D(n){void 0!==n&&(B.attr("src",n[0]),M.attr("src",n[0]).css({width:n[3]+"px",height:n[4]+"px"}),P.css({width:n[3]+"px",height:n[4]+"px",top:n[5]+"px",left:n[6]+"px",position:"relative"}),H.css({width:n[7]+"px",height:n[7]+"px"}),B.css({width:n[8]+"px",height:n[9]+"px"}))}function E(n,t){var e=new Image;if(e.src=n,void 0===t)return{width:e.width,height:e.height};e.complete?t(e.width,e.height):e.onload=function(){t(e.width,e.height)}}function F(n,t,e){var o,i=[];"string"==typeof n?o=n:(t=(n=E(o=n.attr("src"))).width,e=n.height),i[0]=o,i[1]=t,i[2]=e;t=i[1]/i[2];return 1==t?(i[3]=r,i[4]=r,i[5]=0,i[6]=0,i[7]=r/2,i[8]=2*r,i[9]=2*r,v.append('<span><img src="'.concat(o,'" width="').concat(N.navWidth,'" height="').concat(N.navHeight,'"/></span>'))):1<t?(i[3]=r,i[4]=r/t,i[5]=(r-i[4])/2,i[6]=0,i[7]=i[4]/2,i[8]=2*r*t,i[9]=2*r,e=(N.navHeight-N.navWidth/t)/2,v.append('<span><img src="'.concat(o,'" width="').concat(N.navWidth,"\" style='top:").concat(e,"px;' /></span>"))):t<1&&(i[3]=r*t,i[4]=r,i[5]=0,i[6]=(r-i[3])/2,i[7]=i[3]/2,i[8]=2*r,i[9]=2*r/t,t=(N.navWidth-N.navHeight*t)/2,v.append('<span><img src="'.concat(o,'" height="').concat(N.navHeight,'" style="left:').concat(t,'px;"/></span>'))),i}i.fn.extend({exzoom:function(n,t){if(0===arguments.length||"object"===_typeof(n)&&!t){if(0!==this.length)return e.init.apply(this,arguments);i.error("Selector is empty when call jQuery.exzomm")}else{if(e[n])return e[n].apply(this,Array.prototype.slice.call(arguments,1));i.error("Method "+n+"does not exist on jQuery.exzomm")}}})}(jQuery,window);